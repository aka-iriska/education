     1                                  section .data
     2                                  ; matr dd 2,3,1,-1,8,9,-2
     3                                  ; dd 6,-8,7,5,4,11,2
     4                                  ; dd 12,3,0,-13,5,7,2
     5                                  ; dd 6,23,103,4,5,-1,0
     6                                  ; dd 0,-1,4,6,12,5,-6
     7 00000000 05000000                matr_rows dd 5 ;РєРѕР»РёС‡РµСЃС‚РІРѕ СЃС‚СЂРѕРє
     8 00000004 07000000                matr_columns dd 7 ;РєРѕР»РёС‡РµСЃС‚РІРѕ СЃС‚РѕР»Р±С†РѕРІ
     9 00000008 D098D0B7D0BDD0B0D1-     StartMsg db "РР·РЅР°С‡Р°Р»СЊРЅР°СЏ РјР°С‚СЂРёС†Р°:", 10
     9 00000011 87D0B0D0BBD18CD0BD-
     9 0000001A D0B0D18F20D0BCD0B0-
     9 00000023 D182D180D0B8D186D0-
     9 0000002C B03A0A             
    10                                  lenStartMsg equ $-StartMsg
    11 0000002F D098D0B7D0BCD0B5D0-     EndMsg db "РР·РјРµРЅРµРЅРЅР°СЏ РјР°С‚СЂРёС†Р°:", 10
    11 00000038 BDD0B5D0BDD0BDD0B0-
    11 00000041 D18F20D0BCD0B0D182-
    11 0000004A D180D0B8D186D0B03A-
    11 00000053 0A                 
    12                                  lenEndMsg equ $-EndMsg
    13                                  
    14                                  section .bss
    15 00000000 <res 8Ch>               matr resd 35;СЂРµР·РµСЂРІРёСЂСѓРµРј РјРµСЃС‚Рѕ РґР»СЏ 35 4-Р±Р°Р№С‚РѕРІС‹С… С‡РёСЃРµР» РјР°С‚СЂРёС†С‹ 5С…7
    16                                  
    17                                  section .text
    18                                  global _start
    19                                  
    20                                  _start:
    21                                  ;РІРІРѕРґ РјР°С‚СЂРёС†С‹
    22 00000000 E8(00000000)            call ReadMatrix
    23                                  ;РІС‹РІРѕРґ РёР·РЅ РјР°С‚СЂРёС†С‹
    24 00000005 B804000000                  mov eax, 4 ; СЃРёСЃС‚РµРјРЅР°СЏ С„СѓРЅРєС†РёСЏ 4 (write)
    25 0000000A BB01000000                  mov ebx, 1 ; РґРµСЃРєСЂРёРїС‚РѕСЂ С„Р°Р№Р»Р° stdout=1
    26 0000000F B9[08000000]                mov ecx, StartMsg ; Р°РґСЂРµСЃ РІС‹РІРѕРґРёРјРѕР№ СЃС‚СЂРѕРєРё
    27 00000014 BA27000000                  mov edx, lenStartMsg ; РґР»РёРЅР° РІС‹РІРѕРґРёРјРѕР№ СЃС‚СЂРѕРєРё
    28 00000019 CD80                        int 80h ; РІС‹Р·РѕРІ СЃРёСЃС‚РµРјРЅРѕР№ С„СѓРЅРєС†РёРё
    29 0000001B E8(8E000000)                call WriteMatrix
    30                                  ;РѕСЃРЅРѕРІРЅР°СЏ РїСЂРѕРіСЂР°РјРјР°
    31 00000020 8B0D[04000000]          mov ecx, [matr_columns] ;РєРѕР»РёС‡РµСЃС‚РІРѕ
    32                                  cycle_colomns:
    33 00000026 89C8                        mov eax, ecx ;СЃРјРµС‰РµРЅРёРµ РїРѕ СЃС‚РѕР»Р±С†Сѓ
    34 00000028 48                          dec eax
    35                                      ;СѓРјРЅРѕР¶РµРЅРёРµ ebx РЅР° 4
    36 00000029 BB04000000                  mov ebx, 4
    37 0000002E F7E3                        mul ebx
    38 00000030 89C3                        mov ebx, eax
    39                                      ;РїСЂРѕРІРµСЂРєР° С‡С‘С‚РЅРѕСЃС‚Рё:
    40 00000032 F7C101000000                test ecx, 1
    41 00000038 753A                        jnz next ;РµСЃР»Рё СЃС‚РѕР»Р±РµС† РЅРµС‡РµС‚РЅС‹Р№
    42 0000003A 51                          push ecx
    43 0000003B A1[00000000]                mov eax, [matr_rows]
    44                                      ;РґРµР»РµРЅРёРµ eax РЅР° 2
    45 00000040 BE02000000                  mov esi, 2
    46 00000045 F7F6                        div esi
    47 00000047 89C1                        mov ecx, eax ;Р·Р°РїРёСЃС‹РІР°РµРј С‚РѕР»СЊРєРѕ РїРѕР»РѕРІРёРЅСѓ РјР°С‚СЂРёС†С‹
    48 00000049 BE01000000                  mov esi, 1;СЃС‡С‘С‚С‡РёРє
    49                                      .cycle_rows:
    50 0000004E 8B83[00000000]                  mov eax, [matr + ebx]
    51 00000054 E83D000000                      call Arifmetic
    52 00000059 8B943B[00000000]                mov edx, [matr + ebx + edi]
    53 00000060 8993[00000000]                  mov [matr + ebx], edx
    54 00000066 89843B[00000000]                mov [matr + ebx + edi], eax
    55 0000006D 46                              inc esi
    56 0000006E 83C31C                          add ebx, 28 ;РїРµСЂРµС…РѕРґ Рє СЃР»РµРґ СЌР»РµРјРµРЅС‚Сѓ РІ СЃС‚РѕР»Р±С†Рµ 7*4Р±Р°Р№С‚Р°
    57 00000071 E2DB                            loop .cycle_rows
    58 00000073 59                          pop ecx
    59                                      next:
    60 00000074 E2B0                        loop cycle_colomns
    61                                  ; РІС‹РІРѕРґ РєРѕРЅРµС‡РЅРѕР№ РјР°С‚СЂРёС†С‹
    62 00000076 B804000000                  mov eax, 4 ; СЃРёСЃС‚РµРјРЅР°СЏ С„СѓРЅРєС†РёСЏ 4 (write)
    63 0000007B BB01000000                  mov ebx, 1 ; РґРµСЃРєСЂРёРїС‚РѕСЂ С„Р°Р№Р»Р° stdout=1
    64 00000080 B9[2F000000]                mov ecx, EndMsg ; Р°РґСЂРµСЃ РІС‹РІРѕРґРёРјРѕР№ СЃС‚СЂРѕРєРё
    65 00000085 BA25000000                  mov edx, lenEndMsg ; РґР»РёРЅР° РІС‹РІРѕРґРёРјРѕР№ СЃС‚СЂРѕРєРё
    66 0000008A CD80                        int 80h ; РІС‹Р·РѕРІ СЃРёСЃС‚РµРјРЅРѕР№ С„СѓРЅРєС†РёРё
    67 0000008C E8(8E000000)                call WriteMatrix
    68                                  ;РІС‹С…РѕРґ
    69 00000091 E8(4E010000)            call Exit
    70                                  Arifmetic:
    71                                      ;Р±С‹Р»Р° РІС‹РІРµСЂРµРЅР° СЃР»РµРґСѓСЋС‰Р°СЏ Р·Р°РІРёСЃРёРјРѕСЃС‚СЊ:
    72                                      ;РЅРѕРјРµСЂ РїСЂРѕС‚РёРІРѕРїРѕР»РѕР¶РЅРѕРіРѕ СЌР»РµРјРµРЅС‚Р° РІС‹С‡РёСЃР»СЏРµС‚СЃСЏ С‚Р°Рє:
    73                                      ;РЅРѕРјРµСЂ СЌР»РµРјРµРЅС‚Р° + РєРѕР»РёС‡РµСЃС‚РІРѕ СЃС‚РѕР»Р±С†РѕРІ*(РєРѕР»-РІРѕ СЃС‚СЂРѕРє +1 - 2*РЅРѕРјРµСЂ СЃС‚СЂРѕРєРё)
    74 00000096 50                          push eax
    75 00000097 53                          push ebx
    76 00000098 56                          push esi
    77 00000099 89F0                        mov eax, esi
    78 0000009B BB02000000                  mov ebx, 2
    79 000000A0 F7E3                        mul ebx ; esi - РЅРѕРјРµСЂ СЃС‚СЂРѕРєРё, РЅР°С‡РёРЅР°СЏ СЃ 1
    80 000000A2 89C6                        mov esi, eax
    81 000000A4 A1[00000000]                mov eax, [matr_rows] ;РєРѕР»-РІРѕ СЃС‚СЂРѕРє
    82 000000A9 40                          inc eax ;РєРѕР»-РІРѕ СЃС‚СЂРѕРє+1
    83 000000AA 29F0                        sub eax, esi ;РєРѕР»-РІРѕ СЃС‚СЂРѕРє+1 - 2*РЅРѕРјРµСЂ СЃС‚СЂРѕРєРё
    84 000000AC F725[04000000]              mul dword[matr_columns] ;РєРѕР»-РІРѕ СЃС‚РѕР»Р±С†РѕРІ * СЂРµР·-С‚Р°С‚ СЂР°Р·РЅРѕСЃС‚Рё
    85 000000B2 BB04000000                  mov ebx, 4
    86 000000B7 F7E3                        mul ebx
    87 000000B9 89C7                        mov edi, eax ; СЃРѕС…СЂР°РЅСЏРµРј СЂРµР·СѓР»СЊС‚Р°С‚ РїСЂРѕРёР·РІРµРґРµРЅРёСЏ, РЅРѕРјРµСЂ СЌР»РµРјРµРЅС‚Р° РґРѕР±Р°РІРёРј РІ РѕСЃРЅ РїСЂРѕРіСЂР°РјРјРµ
    88 000000BB 5E                          pop esi
    89 000000BC 5B                          pop ebx
    90 000000BD 58                          pop eax
    91 000000BE C3                          ret
    92                                  %include "matrixLib.asm"
     1                              <1> section .data:
     2 00000000 200A                <1> probel db " ", 10; СЃРёРјРІРѕР» РЅРѕРІРѕР№ СЃС‚СЂРѕРєРё
     3 00000002 D092D0B2D0B5D0B4D0- <1> InputMsg db "Р’РІРµРґРёС‚Рµ С‡РёСЃР»Р° СЃС‚СЂРѕРєРё РјР°С‚СЂРёС†С‹", 10
     3 0000000B B8D182D0B520D187D0- <1>
     3 00000014 B8D181D0BBD0B020D1- <1>
     3 0000001D 81D182D180D0BED0BA- <1>
     3 00000026 D0B820D0BCD0B0D182- <1>
     3 0000002F D180D0B8D186D18B0A  <1>
     4                              <1> lenInputMsg equ $-InputMsg
     5 00000038 4572726F723A20496E- <1> ErrorStr db "Error: Invalid input format", 10
     5 00000041 76616C696420696E70- <1>
     5 0000004A 757420666F726D6174- <1>
     5 00000053 0A                  <1>
     6                              <1> lenError equ $-ErrorStr
     7 00000054 526F773A200A        <1> RowMsg db "Row: ", 10
     8                              <1> lenRowMsg equ $-RowMsg
     9                              <1> 
    10                              <1> section .bss ; Р‘СѓС„РµСЂ РґР»СЏ РІРІРѕРґР° С‡РёСЃРµР»
    11 0000008C <res Ah>            <1> NumberBuf resb 10
    12 00000096 <res Ah>            <1> InBuf resb 10 ; Р±СѓС„РµСЂ РґР»СЏ РІРІРѕРґРёРјРѕР№ СЃС‚СЂРѕРєРё
    13                              <1> lenIn equ $-InBuf
    14 000000A0 <res 32h>           <1> OutBuf resb 50
    15                              <1> lenOut equ $-OutBuf
    16                              <1> 
    17                              <1> 
    18                              <1> section _text
    19                              <1> ReadMatrix:
    20 00000000 50                  <1>     push eax
    21 00000001 53                  <1>     push ebx
    22 00000002 51                  <1>     push ecx
    23 00000003 52                  <1>     push edx
    24 00000004 56                  <1>     push esi
    25 00000005 57                  <1>     push edi
    26 00000006 BE[00000000]        <1>     mov esi, matr ; Р·Р°РіСЂСѓР·РєР° Р°РґСЂРµСЃР° РјР°С‚СЂРёС†С‹ РІ СЂРµРіРёСЃС‚СЂ esi
    27 0000000B 8B0D[00000000]      <1>     mov ecx, [matr_rows] ; Р·Р°РіСЂСѓР·РєР° РєРѕР»РёС‡РµСЃС‚РІР° СЃС‚СЂРѕРє
    28 00000011 8B15[04000000]      <1>     mov edx, [matr_columns] ; Р·Р°РіСЂСѓР·РєР° РєРѕР»РёС‡РµСЃС‚РІР° СЃС‚РѕР»Р±С†РѕРІ
    29                              <1> .write_matrix_loop:
    30 00000017 89D3                <1>     mov ebx, edx ; СЃРѕС…СЂР°РЅСЏРµРј РєРѕР»РёС‡РµСЃС‚РІРѕ СЃС‚РѕР»Р±С†РѕРІ РІ СЂРµРіРёСЃС‚СЂРµ ebx РґР»СЏ РёСЃРїРѕР»СЊР·РѕРІР°РЅРёСЏ РІ С†РёРєР»Рµ
    31 00000019 E819000000          <1>     call .InputMessage
    32                              <1> .write_row_loop:
    33                              <1>     ;read element
    34 0000001E E833000000          <1>     call .ReadElement
    35 00000023 8906                <1>     mov [esi], eax
    36 00000025 83C604              <1>     add esi, 4 ; РїРµСЂРµС…РѕРґ Рє СЃР»РµРґСѓСЋС‰РµРјСѓ СЌР»РµРјРµРЅС‚Сѓ РјР°С‚СЂРёС†С‹ (СЂР°Р·РјРµСЂ СЌР»РµРјРµРЅС‚Р° - 4 Р±Р°Р№С‚Р°)
    37 00000028 4B                  <1>     dec ebx ; СѓРјРµРЅСЊС€Р°РµРј СЃС‡РµС‚С‡РёРє СЃС‚РѕР»Р±С†РѕРІ
    38 00000029 83FB00              <1>     cmp ebx, 0 ; РїСЂРѕРІРµСЂСЏРµРј, Р·Р°РІРµСЂС€РёР»Рё Р»Рё РјС‹ РѕР±СЂР°Р±РѕС‚РєСѓ СЃС‚СЂРѕРєРё
    39 0000002C 75F0                <1>     jnz .write_row_loop ; РµСЃР»Рё РЅРµС‚, РїСЂРѕРґРѕР»Р¶Р°РµРј РІС‹РІРѕРґРёС‚СЊ СЌР»РµРјРµРЅС‚С‹
    40 0000002E E2E7                <1>     loop .write_matrix_loop ; СѓРјРµРЅСЊС€Р°РµРј СЃС‡РµС‚С‡РёРє СЃС‚СЂРѕРє Рё РїСЂРѕРґРѕР»Р¶Р°РµРј РІС‹РІРѕРґРёС‚СЊ
    41 00000030 5F                  <1>     pop edi
    42 00000031 5E                  <1>     pop esi
    43 00000032 5A                  <1>     pop edx
    44 00000033 59                  <1>     pop ecx
    45 00000034 5B                  <1>     pop ebx
    46 00000035 58                  <1>     pop eax
    47 00000036 C3                  <1>     ret
    48                              <1> .InputMessage:
    49 00000037 50                  <1>     push eax
    50 00000038 53                  <1>     push ebx
    51 00000039 51                  <1>     push ecx
    52 0000003A 52                  <1>     push edx
    53 0000003B B804000000          <1>     mov eax, 4 ; СЃРёСЃС‚РµРјРЅР°СЏ С„СѓРЅРєС†РёСЏ 4 (write)
    54 00000040 BB01000000          <1>     mov ebx, 1 ; РґРµСЃРєСЂРёРїС‚РѕСЂ С„Р°Р№Р»Р° stdout=1
    55 00000045 B9[02000000]        <1>     mov ecx, InputMsg ; Р°РґСЂРµСЃ РІС‹РІРѕРґРёРјРѕР№ СЃС‚СЂРѕРєРё
    56 0000004A BA36000000          <1>     mov edx, lenInputMsg ; РґР»РёРЅР° РІС‹РІРѕРґРёРјРѕР№ СЃС‚СЂРѕРєРё
    57 0000004F CD80                <1>     int 80h ; РІС‹Р·РѕРІ СЃРёСЃС‚РµРјРЅРѕР№ С„СѓРЅРєС†РёРё
    58 00000051 5A                  <1>     pop edx
    59 00000052 59                  <1>     pop ecx
    60 00000053 5B                  <1>     pop ebx
    61 00000054 58                  <1>     pop eax
    62 00000055 C3                  <1>     ret
    63                              <1> .ReadElement:
    64 00000056 56                  <1>     push esi
    65 00000057 53                  <1>     push ebx
    66 00000058 51                  <1>     push ecx
    67 00000059 52                  <1>     push edx
    68 0000005A E818000000          <1>     call .Buffer
    69 0000005F BE[96000000]        <1>     mov esi, InBuf
    70 00000064 E8EE000000          <1>     call StrToInt
    71 00000069 83FB00              <1>     cmp ebx, 0
    72 0000006C 0F85C4000000        <1>     jne Error
    73 00000072 5A                  <1>     pop edx
    74 00000073 59                  <1>     pop ecx
    75 00000074 5B                  <1>     pop ebx
    76 00000075 5E                  <1>     pop esi
    77 00000076 C3                  <1>     ret
    78                              <1> .Buffer:
    79 00000077 B803000000          <1>     mov eax, 3 ; СЃРёСЃС‚РµРјРЅР°СЏ С„СѓРЅРєС†РёСЏ 3 (read)
    80 0000007C BB00000000          <1>     mov ebx, 0 ; РґРµСЃРєСЂРёРїС‚РѕСЂ С„Р°Р№Р»Р° stdin=0
    81 00000081 B9[96000000]        <1>     mov ecx, InBuf ; Р°РґСЂРµСЃ Р±СѓС„РµСЂР° РІРІРѕРґР°
    82 00000086 BA0A000000          <1>     mov edx, lenIn ; СЂР°Р·РјРµСЂ Р±СѓС„РµСЂР°
    83 0000008B CD80                <1>     int 80h
    84 0000008D C3                  <1>     ret
    85                              <1> WriteMatrix:
    86 0000008E 50                  <1>     push eax
    87 0000008F 53                  <1>     push ebx
    88 00000090 51                  <1>     push ecx
    89 00000091 52                  <1>     push edx
    90 00000092 56                  <1>     push esi
    91 00000093 57                  <1>     push edi
    92 00000094 BE[00000000]        <1>     mov esi, matr ; Р·Р°РіСЂСѓР·РєР° Р°РґСЂРµСЃР° РјР°С‚СЂРёС†С‹ РІ СЂРµРіРёСЃС‚СЂ esi
    93 00000099 8B0D[00000000]      <1>     mov ecx, [matr_rows] ; Р·Р°РіСЂСѓР·РєР° РєРѕР»РёС‡РµСЃС‚РІР° СЃС‚СЂРѕРє
    94 0000009F 8B15[04000000]      <1>     mov edx, [matr_columns] ; Р·Р°РіСЂСѓР·РєР° РєРѕР»РёС‡РµСЃС‚РІР° СЃС‚РѕР»Р±С†РѕРІ
    95                              <1> 
    96                              <1> .print_matrix_loop:
    97 000000A5 BF[A0000000]        <1>     mov edi, OutBuf ; СѓСЃС‚Р°РЅРѕРІРєР° СѓРєР°Р·Р°С‚РµР»СЏ РЅР° РЅР°С‡Р°Р»Рѕ Р±СѓС„РµСЂР° РґР»СЏ Р·Р°РїРёСЃРё СЌР»РµРјРµРЅС‚РѕРІ
    98 000000AA 89D3                <1>     mov ebx, edx ; СЃРѕС…СЂР°РЅСЏРµРј РєРѕР»РёС‡РµСЃС‚РІРѕ СЃС‚РѕР»Р±С†РѕРІ РІ СЂРµРіРёСЃС‚СЂРµ ebx РґР»СЏ РёСЃРїРѕР»СЊР·РѕРІР°РЅРёСЏ РІ С†РёРєР»Рµ
    99                              <1> 
   100                              <1> .print_row_loop:
   101 000000AC 8B06                <1>     mov eax, [esi] ; Р·Р°РіСЂСѓР·РєР° СЌР»РµРјРµРЅС‚Р° РјР°С‚СЂРёС†С‹ РІ eax
   102 000000AE E839000000          <1>     call .Output
   103 000000B3 83C604              <1>     add esi, 4 ; РїРµСЂРµС…РѕРґ Рє СЃР»РµРґСѓСЋС‰РµРјСѓ СЌР»РµРјРµРЅС‚Сѓ РјР°С‚СЂРёС†С‹ (СЂР°Р·РјРµСЂ СЌР»РµРјРµРЅС‚Р° - 4 Р±Р°Р№С‚Р°)
   104 000000B6 4B                  <1>     dec ebx ; СѓРјРµРЅСЊС€Р°РµРј СЃС‡РµС‚С‡РёРє СЃС‚РѕР»Р±С†РѕРІ
   105                              <1> 
   106 000000B7 83FB00              <1>     cmp ebx, 0 ; РїСЂРѕРІРµСЂСЏРµРј, Р·Р°РІРµСЂС€РёР»Рё Р»Рё РјС‹ РѕР±СЂР°Р±РѕС‚РєСѓ СЃС‚СЂРѕРєРё
   107 000000BA 75F0                <1>     jnz .print_row_loop ; РµСЃР»Рё РЅРµС‚, РїСЂРѕРґРѕР»Р¶Р°РµРј РІС‹РІРѕРґРёС‚СЊ СЌР»РµРјРµРЅС‚С‹
   108 000000BC 83C701              <1>     add edi, 1 ;РґРѕ СЌС‚РѕРіРѕ РјС‹ РїРµСЂРµРєСЂС‹РІР°Р»Рё РјР°СЂРєРµСЂ РєРѕРЅС†Р° СЃС‚СЂРѕРєРё, РєРѕРіРґР° РІСЃРµ СЌР»РµРјРµРЅС‚С‹ РѕРґРЅР№Рѕ СЃС‚СЂРѕРєРё РІС‹РІРµРґРµРЅС‹ РІ Р±СѓС„РµСЂ РґРѕР±Р°РІР»СЏРµРј РµРіРѕ
   109 000000BF E850000000          <1>     call .NewLineOutput ; РІС‹РІРѕРґРёРј СЃРёРјРІРѕР» РЅРѕРІРѕР№ СЃС‚СЂРѕРєРё
   110 000000C4 E2DF                <1>     loop .print_matrix_loop ; СѓРјРµРЅСЊС€Р°РµРј СЃС‡РµС‚С‡РёРє СЃС‚СЂРѕРє Рё РїСЂРѕРґРѕР»Р¶Р°РµРј РІС‹РІРѕРґРёС‚СЊ
   111 000000C6 5F                  <1>     pop edi
   112 000000C7 5E                  <1>     pop esi
   113 000000C8 5A                  <1>     pop edx
   114 000000C9 59                  <1>     pop ecx
   115 000000CA 5B                  <1>     pop ebx
   116 000000CB 58                  <1>     pop eax
   117 000000CC C3                  <1>     ret
   118                              <1> .StringOutput:
   119 000000CD 50                  <1>     push eax
   120 000000CE 53                  <1>     push ebx
   121 000000CF 51                  <1>     push ecx
   122 000000D0 52                  <1>     push edx
   123 000000D1 B804000000          <1>     mov eax, 4 ; СЃРёСЃС‚РµРјРЅР°СЏ С„СѓРЅРєС†РёСЏ 4 (write)
   124 000000D6 BB01000000          <1>     mov ebx, 1 ; РґРµСЃРєСЂРёРїС‚РѕСЂ С„Р°Р№Р»Р° stdout=1
   125 000000DB B9[54000000]        <1>     mov ecx, RowMsg ; Р°РґСЂРµСЃ РІС‹РІРѕРґРёРјРѕР№ СЃС‚СЂРѕРєРё
   126 000000E0 BA06000000          <1>     mov edx, lenRowMsg ; РґР»РёРЅР° СЃС‚СЂРѕРєРё
   127 000000E5 CD80                <1>     int 80h ; РІС‹Р·РѕРІ СЃРёСЃС‚РµРјРЅРѕР№ С„СѓРЅРєС†РёРё
   128 000000E7 5A                  <1>     pop edx
   129 000000E8 59                  <1>     pop ecx
   130 000000E9 5B                  <1>     pop ebx
   131 000000EA 58                  <1>     pop eax
   132 000000EB C3                  <1>     ret
   133                              <1> 
   134                              <1> .Output:
   135 000000EC 56                  <1>     push esi
   136 000000ED 50                  <1>     push eax
   137 000000EE 53                  <1>     push ebx
   138 000000EF 51                  <1>     push ecx
   139 000000F0 52                  <1>     push edx
   140 000000F1 BE[8C000000]        <1>     mov esi, NumberBuf ; СѓСЃС‚Р°РЅРѕРІРєР° СѓРєР°Р·Р°С‚РµР»СЏ РЅР° РЅР°С‡Р°Р»Рѕ Р±СѓС„РµСЂР° РІС‹РІРѕРґР°
   141 000000F6 E8B1000000          <1>     call IntToStr ; РІС‹Р·РѕРІ С„СѓРЅРєС†РёРё РґР»СЏ РїСЂРµРѕР±СЂР°Р·РѕРІР°РЅРёСЏ С‡РёСЃР»Р° РІ СЃС‚СЂРѕРєСѓ
   142 000000FB 8B1E                <1>     mov ebx, dword[esi]
   143 000000FD 891F                <1>     mov [edi], ebx ; СЃРѕС…СЂР°РЅСЏРµРј СЃС‚СЂРѕРєСѓ РІ Р±СѓС„РµСЂРµ
   144 000000FF 01C7                <1>     add edi, eax ; РїРµСЂРµРјРµС‰Р°РµРј СѓРєР°Р·Р°С‚РµР»СЊ РЅР° СЃР»РµРґСѓСЋС‰РёР№ СЌР»РµРјРµРЅС‚ РїРѕ СЂР°Р·РјРµСЂСѓ СЃС‚СЂРѕРєРё
   145 00000101 83EF01              <1>     sub edi, 1 ;РЅРµ СѓС‡РёС‚С‹РІР°РµРј РјР°СЂРєРµСЂ РєРѕРЅС†Р° СЃС‚СЂРѕРєРё
   146 00000104 A1[00000000]        <1>     mov eax, [probel] ;РґРѕР±Р°РІР»СЏРµРј РїСЂРѕР±РµР» РјРµР¶РґСѓ СЌР»РµРјРµРЅС‚Р°РјРё
   147 00000109 8907                <1>     mov [edi], eax
   148 0000010B 83C701              <1>     add edi, 1 ;РїРµСЂРµРјРµС‰Р°РµРјСЃСЏ РЅР° 1 Р±Р°Р№С‚, С‚Р°Рє РєР°Рє РґРѕР±РІРёР»Рё РїСЂРѕР±РµР» Рё РІ Р±СѓРґСѓС‰РµРј РµРіРѕ РЅРµ РїРµСЂРµРєСЂС‹РІР°С‚СЊ
   149 0000010E 5A                  <1>     pop edx
   150 0000010F 59                  <1>     pop ecx
   151 00000110 5B                  <1>     pop ebx
   152 00000111 58                  <1>     pop eax
   153 00000112 5E                  <1>     pop esi
   154 00000113 C3                  <1>     ret
   155                              <1> 
   156                              <1> .NewLineOutput:
   157 00000114 50                  <1>     push eax
   158 00000115 53                  <1>     push ebx
   159 00000116 51                  <1>     push ecx
   160 00000117 52                  <1>     push edx
   161 00000118 B804000000          <1>     mov eax, 4 ; СЃРёСЃС‚РµРјРЅР°СЏ С„СѓРЅРєС†РёСЏ 4 (write)
   162 0000011D BB01000000          <1>     mov ebx, 1 ; РґРµСЃРєСЂРёРїС‚РѕСЂ С„Р°Р№Р»Р° stdout=1
   163 00000122 B9[A0000000]        <1>     mov ecx, OutBuf ; Р°РґСЂРµСЃ Р±СѓС„РµСЂР°
   164 00000127 89FA                <1>     mov edx, edi ; РґР»РёРЅР° Р±СѓС„РµСЂР° (РєРѕР»РёС‡РµСЃС‚РІРѕ Р·Р°РїРёСЃР°РЅРЅС‹С… СЌР»РµРјРµРЅС‚РѕРІ)
   165 00000129 81EA[A0000000]      <1>     sub edx, OutBuf ; РІС‹С‡РёСЃР»СЏРµРј РґР»РёРЅСѓ Р±СѓС„РµСЂР° РІ Р±Р°Р№С‚Р°С…
   166 0000012F CD80                <1>     int 80h ; РІС‹Р·РѕРІ СЃРёСЃС‚РµРјРЅРѕР№ С„СѓРЅРєС†РёРё РґР»СЏ РІС‹РІРѕРґР° СЃС‚СЂРѕРєРё
   167 00000131 5A                  <1>     pop edx
   168 00000132 59                  <1>     pop ecx
   169 00000133 5B                  <1>     pop ebx
   170 00000134 58                  <1>     pop eax
   171 00000135 C3                  <1>     ret
   172                              <1> Error:
   173 00000136 B804000000          <1>     mov eax, 4 ; СЃРёСЃС‚РµРјРЅР°СЏ С„СѓРЅРєС†РёСЏ 4 (write)
   174 0000013B BB01000000          <1>     mov ebx, 1 ; РґРµСЃРєСЂРёРїС‚РѕСЂ С„Р°Р№Р»Р° stdout=1
   175 00000140 B9[38000000]        <1>     mov ecx, ErrorStr ; Р°РґСЂРµСЃ СЃРѕРѕР±С‰РµРЅРёСЏ РѕР± РѕС€РёР±РєРµ
   176 00000145 BA1C000000          <1>     mov edx, lenError ; РґР»РёРЅР° СЃРѕРѕР±С‰РµРЅРёСЏ РѕР± РѕС€РёР±РєРµ
   177 0000014A CD80                <1>     int 80h ; РІС‹Р·РѕРІ СЃРёСЃС‚РµРјРЅРѕР№ С„СѓРЅРєС†РёРё
   178 0000014C EB00                <1>     jmp Exit
   179                              <1> Exit:
   180 0000014E B801000000          <1>     mov eax, 1 ; СЃРёСЃС‚РµРјРЅР°СЏ С„СѓРЅРєС†РёСЏ 1 (exit)
   181 00000153 31DB                <1>     xor ebx, ebx ; РєРѕРґ РІРѕР·РІСЂР°С‚Р° 0
   182 00000155 CD80                <1>     int 80h ; РІС‹Р·РѕРІ СЃРёСЃС‚РµРјРЅРѕР№ С„СѓРЅРєС†РёРё
   183                              <1> %include "../lib.asm"
     1                              <2>     section _text
     2                              <2> StrToInt:
     3 00000157 57                  <2>          push   edi
     4 00000158 B739                <2>          mov    bh, '9'
     5 0000015A B330                <2>          mov    bl, '0'
     6 0000015C 56                  <2>          push   esi     ; сохраняем адрес исходной строки
     7 0000015D 803E2D              <2>          cmp    byte[esi], '-'
     8 00000160 7501                <2>          jne   .prod
     9 00000162 46                  <2>          inc    esi     ; пропускаем знак
    10 00000163 FC                  <2> .prod    cld
    11 00000164 6631FF              <2>          xor    di, di  ; обнуляем будущее число
    12 00000167 AC                  <2> .cycle:  lodsb          ; загружаем символ (цифру)
    13 00000168 3C0A                <2>          cmp    al, 10  ; если 10, то на конец
    14 0000016A 741F                <2>          je     .Return
    15 0000016C 38D8                <2>          cmp    al, bl  ; сравниваем с кодом нуля
    16 0000016E 722F                <2>          jb     .Error  ; "ниже" – Ошибка
    17 00000170 38F8                <2>          cmp    al, bh  ; сравниваем с кодом девяти 
    18 00000172 772B                <2>          ja     .Error  ; "выше" – Ошибка
    19 00000174 2C30                <2>          sub    al, 30h ; получаем цифру из символа
    20 00000176 6698                <2>          cbw            ; расширяем до слова
    21 00000178 6650                <2>          push   ax      ; сохраняем в стеке
    22 0000017A 66B80A00            <2>          mov    ax, 10  ; заносим 10 в AX
    23 0000017E 66F7E7              <2>          mul    di      ; умножаем, результат в DX:AX
    24 00000181 665F                <2>          pop    di      ; в DI – очередная цифра
    25 00000183 6601F8              <2>          add    ax, di
    26 00000186 6689C7              <2>          mov    di, ax  ; в DI – накопленное число        
    27 00000189 EBDC                <2>          jmp    .cycle
    28 0000018B 5E                  <2> .Return: pop    esi
    29 0000018C BB00000000          <2>          mov    ebx, 0
    30 00000191 803E2D              <2>          cmp    byte[esi], '-'
    31 00000194 7503                <2>          jne    .J
    32 00000196 66F7DF              <2>          neg    di
    33 00000199 6689F8              <2> .J       mov    ax, di
    34 0000019C 98                  <2>          cwde
    35 0000019D EB0B                <2>          jmp    .R
    36 0000019F 5E                  <2> .Error:  pop    esi
    37 000001A0 B800000000          <2>          mov    eax, 0
    38 000001A5 BB01000000          <2>          mov    ebx, 1
    39 000001AA 5F                  <2> .R       pop    edi
    40 000001AB C3                  <2>          ret
    41                              <2> IntToStr: 
    42 000001AC 57                  <2>          push   edi
    43 000001AD 53                  <2>          push   ebx
    44 000001AE 52                  <2>          push   edx
    45 000001AF 51                  <2>          push   ecx
    46 000001B0 56                  <2> 		 push   esi
    47 000001B1 C60600              <2> 		 mov    byte[esi],0 ; на место знака
    48 000001B4 83F800              <2>          cmp    eax,0
    49 000001B7 7D05                <2>          jge    .l1
    50 000001B9 F7D8                <2>          neg    eax
    51 000001BB C6062D              <2>          mov    byte[esi],'-'
    52 000001BE C646060A            <2> .l1      mov    byte[esi+6],10
    53 000001C2 BF05000000          <2>          mov    edi,5
    54 000001C7 66BB0A00            <2>          mov    bx,10
    55 000001CB 6699                <2> .again:  cwd           ; расширили слово до двойного
    56 000001CD 66F7F3              <2>          div    bx     ; делим результат на 10
    57 000001D0 80C230              <2>          add    dl,30h ; получаем из остатка код цифры
    58 000001D3 88143E              <2>          mov    [esi+edi],dl ; пишем символ в строку
    59 000001D6 4F                  <2>          dec    edi    ; переводим указатель на  
    60                              <2>                        ; предыдущую позицию
    61 000001D7 6683F800            <2>          cmp    ax, 0  ; преобразовали все число?
    62 000001DB 75EE                <2>          jne    .again
    63 000001DD B906000000          <2>          mov    ecx, 6
    64 000001E2 29F9                <2>          sub    ecx, edi ; длина результата+знак
    65 000001E4 89C8                <2> 		 mov    eax,ecx
    66 000001E6 40                  <2> 		 inc    eax      ; длина результата+0А
    67 000001E7 46                  <2>          inc    esi      ; пропускаем знак
    68 000001E8 56                  <2> 		 push   esi
    69 000001E9 8D343E              <2>          lea    esi,[esi+edi] ; начало результата
    70 000001EC 5F                  <2> 		 pop    edi
    71 000001ED F3A4                <2>          rep movsb
    72 000001EF 5E                  <2>          pop    esi  
    73 000001F0 59                  <2>          pop    ecx
    74 000001F1 5A                  <2>          pop    edx
    75 000001F2 5B                  <2>          pop    ebx
    76 000001F3 5F                  <2>          pop    edi
    77 000001F4 C3                  <2>          ret
